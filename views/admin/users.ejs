<%- include('../partials/header') %>

<style>
  .admin-table-wrapper {
    background: var(--bg-surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    overflow: hidden;
    margin-bottom: 2rem;
  }

  .admin-table-wrapper .admin-section-header {
    background: var(--bg-card);
    border-bottom: 1px solid var(--border);
    padding: 1.5rem;
    margin-bottom: 0;
  }

  .admin-table-wrapper .data-table {
    background: var(--bg-surface);
    border: none;
    border-radius: 0;
    overflow: visible;
  }

  .admin-table-wrapper .data-table thead {
    background: var(--bg-card);
  }

  .admin-table-wrapper .data-table th {
    padding: 1rem;
    border-bottom: 1px solid var(--border);
  }

  .admin-table-wrapper .data-table td {
    padding: 0.75rem 1rem;
    box-sizing: border-box;
  }

  .admin-table-wrapper .data-table tbody tr {
    box-shadow: inset 0 -1px 0 0 var(--border);
  }

  .admin-table-wrapper .data-table tbody tr:last-child {
    box-shadow: none;
  }

  .admin-table-wrapper .data-table tbody tr:hover {
    background: rgba(6, 182, 212, 0.05);
  }
</style>

<section class="admin-header">
  <div class="container">
    <h1 class="page-title">&#9881; Управление пользователями</h1>
    <nav class="admin-nav">
      <a href="/admin" class="admin-tab">Главная</a>
      <a href="/admin/news" class="admin-tab">Новости</a>
      <a href="/admin/servers" class="admin-tab">Сервера</a>
      <a href="/admin/users" class="admin-tab active">Пользователи</a>
      <a href="/admin/settings" class="admin-tab">Настройки</a>
    </nav>
  </div>
</section>

<section class="section container">
  <div class="admin-table-wrapper">
    <div class="admin-section-header">
      <h2>Пользователи</h2>
      <span style="font-size: 0.9rem; color: var(--text-secondary); font-weight: normal;"><%= users.length %> пользователей</span>
    </div>

    <div class="table-responsive">
      <table class="data-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Имя</th>
            <th>Email</th>
            <th>Роль</th>
            <th>Посл. вход</th>
            <th>Посл. IP</th>
            <th>Регистрация</th>
            <th>Действия</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(function(u) { %>
            <tr>
              <td><%= u.id %></td>
              <td><strong><%= u.username %></strong></td>
              <td><%= u.email || '-' %></td>
              <td>
                <span class="role-badge role-<%= u.role %>"><%= u.role %></span>
              </td>
              <td><%= u.last_login ? new Date(u.last_login).toLocaleString() : 'Никогда' %></td>
              <td class="mono"><%= u.last_ip || '-' %></td>
              <td><%= new Date(u.created_at).toLocaleDateString() %></td>
              <td class="actions-cell">
                <form action="/admin/users/<%= u.id %>/delete" method="POST" style="display:inline;" onsubmit="return confirm('Удалить пользователя <%= u.username %>?')">
                  <button type="submit" class="btn btn-xs btn-danger">Удалить</button>
                </form>
              </td>
            </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </div>
</section>

<%- include('../partials/footer') %>
